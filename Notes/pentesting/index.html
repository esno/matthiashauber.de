<!doctype html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="description" content="open-source tech stuff" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300&display=swap" rel="stylesheet" />
  <link href="../../style.css" rel="stylesheet" />
  <title>matthiashauber - open-source tech stuff</title>

<meta name="google-adsense-account" content="ca-pub-7731755775472874">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7731755775472874"
     crossorigin="anonymous"></script>

</head>

<body>
  <div class="sidebar">
    <div class="viewport">
      <div class="topbar">
        <a class="title" href="../../">matthiashauber</a>
        <span class="description">open-source tech stuff</span>
      </div>
      <div class="navigation"><a href="../../">welcome!</a> » <a href="../">Notes</a> » <span>pentesting</span></div>
    </div>
  </div>

  <div class="viewport mainview">
    <div class="directories">
      <a class="back sidelink" href="../">« Back</a>
    </div>
    <div class="page">
      <div class="content"><div id="nmap.md" class="text">
<h1>nmap</h1>

<h2>discover all A/AAAA records of a domain</h2>

<h3>command</h3>

<pre><code>nmap -oX - -sn --script=resolveall --script-args=newtargets,resolveall.hosts=example.org
</code></pre>

<h3>output</h3>

<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE nmaprun&gt;  
&lt;?xml-stylesheet href="file:///usr/bin/../share/nmap/nmap.xsl" type="text/xsl"?&gt;
&lt;!-- Nmap 7.60 scan initiated Tue Aug 29 20:25:44 2017 as: nmap -oX - -sn -&amp;#45;script=resolveall -&amp;#45;script-args=newtargets,resolveall.hosts=example.org --&gt;
&lt;nmaprun scanner="nmap" args="nmap -oX - -sn -&amp;#45;script=resolveall -&amp;#45;script-args=newtargets,resolveall.hosts=example.org" start="1504031144" startstr="Tue Aug 29 20:25:44 2017" version="7.60" xmloutputversion="1.04"&gt;
&lt;verbose level="0"/&gt;
&lt;debugging level="0"/&gt;
&lt;prescript&gt;&lt;script id="resolveall" output="&amp;#xa;  Host &amp;apos;example.org&amp;apos; resolves to:&amp;#xa;    93.184.216.34&amp;#xa;  Successfully added 1 new targets&amp;#xa;"&gt;&lt;table key="hosts"&gt;
&lt;table key="example.org"&gt;
&lt;elem&gt;93.184.216.34&lt;/elem&gt;
&lt;/table&gt;
&lt;/table&gt;
&lt;elem key="newtargets"&gt;1&lt;/elem&gt;
&lt;/script&gt;&lt;/prescript&gt;&lt;host starttime="1504031144" endtime="1504031145"&gt;&lt;status state="up" reason="syn-ack" reason_ttl="0"/&gt;
&lt;address addr="93.184.216.34" addrtype="ipv4"/&gt;
&lt;hostnames&gt;
&lt;/hostnames&gt;
&lt;times srtt="183038" rttvar="183038" to="915190"/&gt;
&lt;/host&gt;
&lt;runstats&gt;&lt;finished time="1504031145" timestr="Tue Aug 29 20:25:45 2017" elapsed="1.53" summary="Nmap done at Tue Aug 29 20:25:45 2017; 1 IP address (1 host up) scanned in 1.53 seconds" exit="success"/&gt;&lt;hosts up="1" down="0" total="1"/&gt;
&lt;/runstats&gt;
&lt;/nmaprun&gt;
</code></pre>

<h2>probe all ports and discover service</h2>

<h3>command</h3>

<pre><code>nmap -oX - -p- --script=banner -sV 127.0.0.1
</code></pre>

<h3>output</h3>

<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE nmaprun&gt;
&lt;?xml-stylesheet href="file:///usr/bin/../share/nmap/nmap.xsl" type="text/xsl"?&gt;
&lt;!-- Nmap 7.60 scan initiated Tue Aug 29 21:24:09 2017 as: nmap -oX - -p- -&amp;#45;script=banner -sV 127.0.0.1 --&gt;
&lt;nmaprun scanner="nmap" args="nmap -oX - -p- -&amp;#45;script=banner -sV 127.0.0.1" start="1504034649" startstr="Tue Aug 29 21:24:09 2017" version="7.60" xmloutputversion="1.04"&gt;
&lt;scaninfo type="syn" protocol="tcp" numservices="65535" services="1-65535"/&gt;
&lt;verbose level="0"/&gt;
&lt;debugging level="0"/&gt;
&lt;host starttime="1504034649" endtime="1504034671"&gt;&lt;status state="up" reason="localhost-response" reason_ttl="0"/&gt;
&lt;address addr="127.0.0.1" addrtype="ipv4"/&gt;
&lt;hostnames&gt;
&lt;hostname name="localhost.localdomain" type="PTR"/&gt;
&lt;/hostnames&gt;
&lt;ports&gt;&lt;extraports state="closed" count="65532"&gt;
&lt;extrareasons reason="resets" count="65532"/&gt;
&lt;/extraports&gt;
&lt;port protocol="tcp" portid="22"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="ssh" product="OpenSSH" version="7.5" extrainfo="protocol 2.0" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:openbsd:openssh:7.5&lt;/cpe&gt;&lt;/service&gt;&lt;script id="banner" output="SSH-2.0-OpenSSH_7.5"/&gt;&lt;/port&gt;
&lt;port protocol="tcp" portid="5432"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="postgresql" product="PostgreSQL DB" version="9.6.0 or later" servicefp="****" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:postgresql:postgresql&lt;/cpe&gt;&lt;/service&gt;&lt;script id="fingerprint-strings" output="&amp;#xa;  SMBProgNeg: &amp;#xa;    SFATAL&amp;#xa;    VFATAL&amp;#xa;    C0A000&amp;#xa;    Munsupported frontend protocol 65363.19778: server supports 1.0 to 3.0&amp;#xa;    Fpostmaster.c&amp;#xa;    L2023&amp;#xa;    RProcessStartupPacket"&gt;&lt;elem key="SMBProgNeg"&gt;&amp;#xa;    SFATAL&amp;#xa;    VFATAL&amp;#xa;    C0A000&amp;#xa;    Munsupported frontend protocol 65363.19778: server supports 1.0 to 3.0&amp;#xa;    Fpostmaster.c&amp;#xa;    L2023&amp;#xa;    RProcessStartupPacket&lt;/elem&gt;
&lt;/script&gt;&lt;/port&gt;
&lt;port protocol="tcp" portid="8081"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="http" product="nginx" version="1.12.1" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:igor_sysoev:nginx:1.12.1&lt;/cpe&gt;&lt;/service&gt;&lt;script id="http-server-header" output="nginx/1.12.1"&gt;&lt;elem&gt;nginx/1.12.1&lt;/elem&gt;
&lt;/script&gt;&lt;/port&gt;
&lt;/ports&gt;
&lt;times srtt="4" rttvar="0" to="100000"/&gt;
&lt;/host&gt;
&lt;runstats&gt;&lt;finished time="1504034671" timestr="Tue Aug 29 21:24:31 2017" elapsed="21.86" summary="Nmap done at Tue Aug 29 21:24:31 2017; 1 IP address (1 host up) scanned in 21.86 seconds" exit="success"/&gt;&lt;hosts up="1" down="0" total="1"/&gt;
&lt;/runstats&gt;
&lt;/nmaprun&gt;
</code></pre>

<h2>OS detection</h2>

<blockquote>
    <p>requires root permissions</p>
</blockquote>

<h3>command</h3>

<pre><code>nmap -oX - -A -p- -sV 127.0.0.1
</code></pre>

<h3>output</h3>

<pre><code>&lt;!DOCTYPE nmaprun&gt;
&lt;?xml-stylesheet href="file:///usr/bin/../share/nmap/nmap.xsl" type="text/xsl"?&gt;
&lt;!-- Nmap 7.60 scan initiated Tue Aug 29 21:12:07 2017 as: nmap -oX - -A -p- -sV 127.0.0.1 --&gt;
&lt;nmaprun scanner="nmap" args="nmap -oX - -A -p- -sV 127.0.0.1" start="1504033927" startstr="Tue Aug 29 21:12:07 2017" version="7.60" xmloutputversion="1.04"&gt;
&lt;scaninfo type="syn" protocol="tcp" numservices="65535" services="1-65535"/&gt;
&lt;verbose level="0"/&gt;
&lt;debugging level="0"/&gt;
&lt;host starttime="1504033928" endtime="1504033936"&gt;&lt;status state="up" reason="localhost-response" reason_ttl="0"/&gt;
&lt;address addr="127.0.0.1" addrtype="ipv4"/&gt;
&lt;hostnames&gt;
&lt;hostname name="localhost.localdomain" type="PTR"/&gt;
&lt;/hostnames&gt;
&lt;ports&gt;&lt;extraports state="closed" count="65532"&gt;
&lt;extrareasons reason="resets" count="65532"/&gt;
&lt;/extraports&gt;
&lt;port protocol="tcp" portid="22"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="ssh" product="OpenSSH" version="7.5" extrainfo="protocol 2.0" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:openbsd:openssh:7.5&lt;/cpe&gt;&lt;/service&gt;&lt;script id="ssh-hostkey" output="****"&gt;&lt;table&gt;
&lt;elem key="fingerprint"&gt;****&lt;/elem&gt;
&lt;elem key="bits"&gt;2048.0&lt;/elem&gt;
&lt;elem key="type"&gt;ssh-rsa&lt;/elem&gt;
&lt;elem key="key"&gt;****&lt;/elem&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;elem key="fingerprint"&gt;****&lt;/elem&gt;
&lt;elem key="bits"&gt;256&lt;/elem&gt;
&lt;elem key="type"&gt;ecdsa-sha2-nistp256&lt;/elem&gt;
&lt;elem key="key"&gt;****&lt;/elem&gt;
&lt;/table&gt;
&lt;table&gt;
&lt;elem key="fingerprint"&gt;****&lt;/elem&gt;
&lt;elem key="bits"&gt;256&lt;/elem&gt;
&lt;elem key="type"&gt;ssh-ed25519&lt;/elem&gt;
&lt;elem key="key"&gt;****&lt;/elem&gt;
&lt;/table&gt;
&lt;/script&gt;&lt;/port&gt;
&lt;port protocol="tcp" portid="5432"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="postgresql" product="PostgreSQL DB" version="9.6.0 or later" servicefp="****" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:postgresql:postgresql&lt;/cpe&gt;&lt;/service&gt;&lt;script id="fingerprint-strings" output="****&lt;/elem&gt;
&lt;/script&gt;&lt;/port&gt;
&lt;port protocol="tcp" portid="8081"&gt;&lt;state state="open" reason="syn-ack" reason_ttl="64"/&gt;&lt;service name="http" product="nginx" version="1.12.1" method="probed" conf="10"&gt;&lt;cpe&gt;cpe:/a:igor_sysoev:nginx:1.12.1&lt;/cpe&gt;&lt;/service&gt;&lt;script id="http-server-header" output="nginx/1.12.1"&gt;&lt;elem&gt;nginx/1.12.1&lt;/elem&gt;
&lt;/script&gt;&lt;script id="http-title" output="****"&gt;&lt;elem key="title"&gt;****&lt;/elem&gt;
&lt;/script&gt;&lt;/port&gt;
&lt;/ports&gt;
&lt;os&gt;&lt;portused state="open" proto="tcp" portid="22"/&gt;
&lt;portused state="closed" proto="tcp" portid="1"/&gt;
&lt;portused state="closed" proto="udp" portid="32710"/&gt;
&lt;osmatch name="Linux 3.8 - 4.9" accuracy="100" line="63233"&gt;
&lt;osclass type="general purpose" vendor="Linux" osfamily="Linux" osgen="3.X" accuracy="100"&gt;&lt;cpe&gt;cpe:/o:linux:linux_kernel:3&lt;/cpe&gt;&lt;/osclass&gt;
&lt;osclass type="general purpose" vendor="Linux" osfamily="Linux" osgen="4.X" accuracy="100"&gt;&lt;cpe&gt;cpe:/o:linux:linux_kernel:4&lt;/cpe&gt;&lt;/osclass&gt;
&lt;/osmatch&gt;
&lt;/os&gt;
&lt;uptime seconds="8180246" lastboot="Sat May 27 04:54:50 2017"/&gt;
&lt;distance value="0"/&gt;
&lt;tcpsequence index="256" difficulty="Good luck!" values="****"/&gt;
&lt;ipidsequence class="All zeros" values="0,0,0,0,0,0"/&gt;
&lt;tcptssequence class="other" values="****"/&gt;
&lt;times srtt="49" rttvar="22" to="100000"/&gt;
&lt;/host&gt;
&lt;runstats&gt;&lt;finished time="1504033936" timestr="Tue Aug 29 21:12:16 2017" elapsed="8.72" summary="Nmap done at Tue Aug 29 21:12:16 2017; 1 IP address (1 host up) scanned in 8.72 seconds" exit="success"/&gt;&lt;hosts up="1" down="0" total="1"/&gt;
&lt;/runstats&gt;
&lt;/nmaprun&gt;
</code></pre>

</div><div class="footer">September 2025 - powered by <a href="https://github.com/shagu/webls">webls</a></div></div>
    </div>
  </div>
</body>

</html>
