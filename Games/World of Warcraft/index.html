<!doctype html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="description" content="open-source tech stuff" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300&display=swap" rel="stylesheet" />
  <link href="../../style.css" rel="stylesheet" />
  <title>matthiashauber - open-source tech stuff</title>

<meta name="google-adsense-account" content="ca-pub-7731755775472874">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7731755775472874"
     crossorigin="anonymous"></script>

</head>

<body>
  <div class="sidebar">
    <div class="viewport">
      <div class="topbar">
        <a class="title" href="../../">matthiashauber</a>
        <span class="description">open-source tech stuff</span>
      </div>
      <div class="navigation"><a href="../../">welcome!</a> » <a href="../">Games</a> » <span>World of Warcraft</span></div>
    </div>
  </div>

  <div class="viewport mainview">
    <div class="directories">
      <a class="back sidelink" href="../">« Back</a>
    </div>
    <div class="page">
      <div class="content"><div id="internals.md" class="text">
<h1>World of Warcraft</h1>

<p>This section ships information and internals of the well-known World of Warcraft.
All information provided has to be understood from an educational point of view.</p>

<h2>authentication</h2>

<p>The world of warcraft clients using a custom version of <a href="http://srp.stanford.edu/whatisit.html">SRP6</a> (Secure Remote Password protocol).
Based on the logic of SRP the server-side never requires a password in cleartext.
Neither on registration nor on authentication.
The server side requires only a 32 bytes large salt as well as the password verifier.</p>

<p>An example implementation for golang is available at <a href="https://github.com/blizzlike-org/wowpasswd">github</a>.</p>

<h2>compute the password verifier</h2>

<p>OpenSSL bignum provides all the necessary tooling to compute all SRP related values.
the password verifier value is based upon a random 32 byte salt whch can be computed through <code>BN_rand(3)</code></p>

<pre><code>#include &lt;openssl/bn.h&gt;

int size = 32;

BIGNUM *salt = BN_new();
BN_rand(salt, size * 8, 0, 1);
</code></pre>

<p>The formula for password verifier <code>v</code> is defined as</p>

<pre><code>v = g^x % N
</code></pre>

<p>Where <code>N</code> is a large safe prime and <code>g</code> is a generator modulo N.
Computing large safe prime numbers may take a lot of time that's why most
WoW emulators are using hardcoded values for that.
So Let's reuse the values from <a href="https://getmangos.eu">mangos</a>-based cores.</p>

<pre><code>N = 894B645E89E1535BBDAD5B8B290650530801B18EBFBF5E8FAB3C82872A3E9BB7
g = 7
</code></pre>

<p>Those values are passed to the client therefore you can select whatever secure prime you prefer.</p>

<blockquote>
    <p>Changing such values afterwards will break already computed password verifiers.</p>
</blockquote>

<p>The value for <code>x</code> will be a sha1 hash of salt and the password <code>p</code></p>

<pre><code>x = sha1(s, p)
</code></pre>

<blockquote>
    <p>SRP describes <code>p</code> as cleartext password while blizzard decided to choose a sha1 hash of
    colon separated username and password - both in capital letters.</p>
</blockquote>

<p>To authenticate users the server must store the salt <code>s</code> as well as the password verifier <code>v</code>.</p>

</div><div class="footer">September 2025 - powered by <a href="https://github.com/shagu/webls">webls</a></div></div>
    </div>
  </div>
</body>

</html>
